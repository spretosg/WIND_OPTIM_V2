---
title: "4b_Q1"
author: "R.Spielhofer"
date: "9 Dezember 2020"
output: html_document
---

```{r setup, include=FALSE}

require(raster)
require(rgdal)
require(dplyr)
require(sf)
require(sp)
require(ggplot2)
require(tmap)
require(tmaptools)
require(DBI)
require(RPostgreSQL)
require(rpostgis)
require(ggpubr)
require(spatstat)
require(rstatix)
require(reticulate)
require(tidyr)
require(maptools)
require(RPostgres)
require(stringr)
require(car)
library(onewaytests)
library(psych)
library(plot3D)
```

#Load the pareto data
```{r}
cur_dat<-Sys.Date()
pareto<-read.csv("Y:/people/spreto/2001_WIND_OPTIM/par_fitness_all_201130.csv", sep=",")

# restrictive scen
tmp_dat<-subset(pareto, pareto$SCENARIO=="B3"|pareto$SCENARIO=="B3_FOR+"|pareto$SCENARIO=="B3_ISOS+"|pareto$SCENARIO=="B3_CRF+")

#relaxing scen
#tmp_dat<-subset(pareto, pareto$SCENARIO=="B4"|pareto$SCENARIO=="B4_FOR-"|pareto$SCENARIO=="B4_ISOS-"|pareto$SCENARIO=="B4_CRF-")
```

# Check data variance and distribution
```{r preconditions}
#1. CHECK FOR NORMAL DISTR
tmp_dat %>%
  group_by(SCENARIO) %>%
  shapiro_test(N_WT)
#density plots per scen
ggplot(data=pareto, aes(x=ENERDENS, group=SCENARIO, fill=SCENARIO)) +
    geom_density(adjust=1.5)+ 
    facet_wrap(~SCENARIO) 
#homogeneity of variance
levene_test(tmp_dat,N_WT~SCENARIO,center = mean)
```

## and the appropriate test to compare the scenario means
```{r tests}

# if both not normal and inhomogeneity of variances == man whitney u test
#make comparison group manual
tmp_dat2<-subset(tmp_dat, tmp_dat$SCENARIO=="B3"|tmp_dat$SCENARIO=="B3_FOR+")

wilcox.test(tmp_dat2$N_WT ~ tmp_dat2$SCENARIO)

#if normal distributed but homogen variances == welch t.test
w<-welch.test(N_WT~SCENARIO,pareto)
paircomp(w)
#if both given == t.test
t.test(a$number_WT,b$number_WT,alternative = "two.sided", var.equal = FALSE)

```

